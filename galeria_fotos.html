<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Galer√≠a PetWise</title>
  <link rel="stylesheet" href="estilo.css"> <!-- tu CSS existente -->
  <script src="https://widget.cloudinary.com/v2.0/global/all.js" type="text/javascript"></script>
</head>
<body>
  <!-- ====== NAVBAR ====== -->
  <nav class="navbar navbar-expand-lg navbar-dark fixed-top">
    <div class="container-fluid px-4">
      <a class="navbar-brand d-flex align-items-center" href="index.html">
        <img src="img/logo.png" alt="PetWise Logo" class="img-fluid" />
        <span>PetWise Company</span>
      </a>

      <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarNav">
        <span class="navbar-toggler-icon"></span>
      </button>

      <div class="collapse navbar-collapse" id="navbarNav">
        <ul class="navbar-nav ms-auto">
          <li class="nav-item">
            <a class="nav-link" href="#" onclick="history.back(); return false;">Atr√°s</a>
          </li>
        </ul>
      </div>
    </div>
  </nav>

  <!-- Hero / Encabezado -->
  <header class="hero">
    <h1>Galer√≠a de Mascotas <span class="highlight">PetWise</span></h1>
    <p>Sub√≠ tu foto y compartila con todos</p>
    <button id="uploadBtn" class="hero1-btn">Subir Foto</button>
  </header>

  <!-- Galer√≠a -->
  <section class="pw-target">
    <h2>Galer√≠a de Fotos</h2>
    <div id="gallery" style="display:grid;grid-template-columns:repeat(auto-fill,minmax(220px,1fr));gap:1rem;margin-top:2rem;"></div>
  </section>

<script>
const cloudName = 'dbjiwrxhg';
const uploadPreset = 'petwise_upload';

const gallery = document.getElementById('gallery');
const uploadBtn = document.getElementById('uploadBtn');

function renderGallery() {
  gallery.innerHTML = '';
  const photos = JSON.parse(localStorage.getItem('petwise_photos') || '[]');
  photos.forEach((photo, index) => {
    const card = document.createElement('div');
    card.className = 'pw-card';
    card.innerHTML = `
      <div class="pw-header">
        <div class="pw-title">${photo.username}</div>
      </div>
      <div class="pw-photo-wrap">
        <img src="${photo.url}" class="pw-photo" />
      </div>
      <div style="margin-top:8px; display:flex; justify-content: space-between; align-items:center;">
        <button class="btn-custom like-btn">${photo.likes || 0} ‚ù§Ô∏è</button>
        <button class="btn-custom delete-btn">üóë Eliminar</button>
      </div>
    `;
    // Likes
    card.querySelector('.like-btn').addEventListener('click', () => {
      photo.likes = (photo.likes || 0) + 1;
      localStorage.setItem('petwise_photos', JSON.stringify(photos));
      renderGallery();
    });
    // Eliminar
    card.querySelector('.delete-btn').addEventListener('click', () => {
      photos.splice(index, 1);
      localStorage.setItem('petwise_photos', JSON.stringify(photos));
      renderGallery();
    });

    gallery.appendChild(card);
  });
}

// Subir foto directamente desde la galer√≠a
uploadBtn.addEventListener('click', () => {
  const myWidget = cloudinary.createUploadWidget({
    cloudName: cloudName,
    uploadPreset: uploadPreset,
    multiple: false,
    maxFileSize: 10485760, // 10MB
    sources: ['local','url','camera'],
    cropping: false
  }, (error, result) => {
    if (!error && result && result.event === "success") {
      // Pedir nombre despu√©s de subir
      let username = prompt("Ingrese su nombre para la foto:");
      if(!username) username = "An√≥nimo";
      const photos = JSON.parse(localStorage.getItem('petwise_photos') || '[]');
      photos.push({url: result.info.secure_url, username, likes:0});
      localStorage.setItem('petwise_photos', JSON.stringify(photos));
      renderGallery();
    }
  });
  myWidget.open();
});

// Mostrar galer√≠a al cargar
renderGallery();
</script>
</body>
</html>
