<header class="hero text-center py-5 mt-5">
  <h1>Galer√≠a de Mascotas <span class="highlight">PetWise</span></h1>
  <p>Sub√≠ tu foto y compartila con todos</p>
  <button id="uploadBtn" class="btn btn-primary">Subir Foto</button>
</header>

<script>
const cloudName = 'dbjiwrxhg';
const uploadPreset = 'petwise_upload';
const gallery = document.getElementById('gallery');
const uploadBtn = document.getElementById('uploadBtn');

function renderGallery() {
  gallery.innerHTML = '';
  const photos = JSON.parse(localStorage.getItem('petwise_photos') || '[]');
  photos.forEach((photo, index) => {
    const card = document.createElement('div');
    card.className = 'pw-card border p-2 rounded';
    card.innerHTML = `
      <div class="pw-header mb-2">
        <div class="pw-title fw-bold">${photo.username}</div>
      </div>
      <div class="pw-photo-wrap mb-2">
        <img src="${photo.url}" class="img-fluid rounded" />
      </div>
      <div class="d-flex justify-content-between align-items-center">
        <button class="btn btn-sm btn-outline-danger like-btn">${photo.likes || 0} ‚ù§Ô∏è</button>
        <button class="btn btn-sm btn-outline-secondary delete-btn">üóë Eliminar</button>
      </div>
    `;
    card.querySelector('.like-btn').addEventListener('click', () => {
      photo.likes = (photo.likes || 0) + 1;
      localStorage.setItem('petwise_photos', JSON.stringify(photos));
      renderGallery();
    });
    card.querySelector('.delete-btn').addEventListener('click', () => {
      photos.splice(index, 1);
      localStorage.setItem('petwise_photos', JSON.stringify(photos));
      renderGallery();
    });

    gallery.appendChild(card);
  });
}

uploadBtn.addEventListener('click', () => {
  const myWidget = cloudinary.createUploadWidget({
    cloudName: cloudName,
    uploadPreset: uploadPreset,
    multiple: false,
    maxFileSize: 10485760,
    sources: ['local','url','camera'],
    cropping: false
  }, (error, result) => {
    if (!error && result && result.event === "success") {
      // Pedir nombre despu√©s de subir
      let username = prompt("Ingrese su nombre para la foto:");
      if(!username) username = "An√≥nimo";
      const photos = JSON.parse(localStorage.getItem('petwise_photos') || '[]');
      photos.push({url: result.info.secure_url, username, likes:0});
      localStorage.setItem('petwise_photos', JSON.stringify(photos));
      renderGallery();
    }
  });
  myWidget.open();
});

renderGallery();
</script>
