<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Galer√≠a PetWise</title>
  <link rel="stylesheet" href="estilo.css">
  <script src="https://widget.cloudinary.com/v2.0/global/all.js" type="text/javascript"></script>
</head>
<body>
  <!-- Hero / Encabezado -->
  <section class="hero1">
    <div class="hero1-content">
      <h1>Galer√≠a de Mascotas <span class="highlight">PetWise</span></h1>
      <p>Sub√≠ tu foto y compartila con todos</p>
      <input type="text" id="username" placeholder="Tu nombre" style="padding:0.5rem;border-radius:8px;margin-bottom:1rem;width:200px;">
      <button id="uploadBtn" class="hero1-btn">üì∑ Subir desde galer√≠a</button>
    </div>
  </section>

  <!-- Galer√≠a -->
  <section class="pw-target">
    <h2>Galer√≠a de Fotos</h2>
    <div id="gallery" style="display:grid;grid-template-columns:repeat(auto-fill,minmax(220px,1fr));gap:1rem;margin-top:2rem;"></div>
  </section>

  <script>
    const cloudName = "dbjiwrxhg";  // Tu cloud name
    const uploadPreset = "petwise_upload"; // Tu upload preset
    const gallery = document.getElementById("gallery");
    const uploadBtn = document.getElementById("uploadBtn");

    // 1Ô∏è‚É£ Cargar fotos desde Cloudinary (b√∫squeda por tag "petwise")
    async function fetchGallery() {
      gallery.innerHTML = "<p>Cargando fotos...</p>";
      try {
        const res = await fetch(`https://res.cloudinary.com/${cloudName}/image/list/petwise.json`);
        const data = await res.json();
        gallery.innerHTML = "";
        data.resources.forEach(item => {
          const card = document.createElement("div");
          card.className = "pw-card";
          card.innerHTML = `
            <div class="pw-photo-wrap">
              <img src="${item.secure_url}" class="pw-photo" />
            </div>
          `;
          gallery.appendChild(card);
        });
      } catch (err) {
        gallery.innerHTML = "<p>No hay fotos todav√≠a</p>";
      }
    }

    // 2Ô∏è‚É£ Subir imagen solo desde galer√≠a (sin c√°mara ni URL)
    uploadBtn.addEventListener("click", () => {
      const username = document.getElementById("username").value.trim();
      if (!username) return alert("Por favor ingresa tu nombre.");

      const myWidget = cloudinary.createUploadWidget(
        {
          cloudName: cloudName,
          uploadPreset: uploadPreset,
          sources: ["local"], // üëà Solo galer√≠a/archivos
          multiple: false,
          tags: ["petwise"], // üëà todas las fotos van con este tag
          maxFileSize: 10485760 // 10MB
        },
        (error, result) => {
          if (!error && result && result.event === "success") {
            console.log("Imagen subida:", result.info.secure_url);
            fetchGallery(); // recargar galer√≠a despu√©s de subir
          }
        }
      );
      myWidget.open();
    });

    // Mostrar galer√≠a al cargar
    fetchGallery();
  </script>
</body>
</html>
